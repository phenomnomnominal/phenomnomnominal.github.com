<!DOCTYPE html>

<html>
<head>
  <title>bra-ket.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div class="container">
    <div class="page">

      <div class="header">
        
          <h1>bra-ket.coffee</h1>
        

        
          <div class="toc">
            <h3>Table of Contents</h3>
            <ol>
              
                
                <li>
                  <a class="source" href="algorithms.html">
                    algorithms.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="bra-ket.html">
                    bra-ket.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="complex.html">
                    complex.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="index.html">
                    index.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="matrix.html">
                    matrix.coffee
                  </a>
                </li>
              
            </ol>
          </div>
        
      </div>

      
        
        <h3 id="-quantum-computer-simulator-quantum-html-"><a href="../quantum.html">Quantum Computer Simulator</a></h3>
<p><em>bra-ket.coffee</em> contains the <strong><code>Bra</code></strong> and <strong><code>Ket</code></strong> classes.</p>
<hr>

        
      
        
        <h2 id="error-types-">Error Types:</h2>
<p>Some specific <strong><code>Error</code></strong> types for these classes:</p>

        
      
        
        <section id='bce'></section>

<ul>
<li><strong><code>BraConstructorError</code></strong>:</li>
</ul>
<blockquote>
<blockquote>
<p>These errors are thrown when something is wrong in the <a href="#bra"><strong><code>Bra</code></strong></a> constructor</p>
</blockquote>
</blockquote>

        
          <div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BraConstructorError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span></pre></div>
        
      
        
        <section id='kce'></section>

<ul>
<li><strong><code>KetConstructorError</code></strong>:</li>
</ul>
<blockquote>
<blockquote>
<p>These errors are thrown when something is wrong in the <a href="#ket"><strong><code>Ket</code></strong></a> constructor</p>
</blockquote>
</blockquote>

        
          <div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KetConstructorError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span></pre></div>
        
      
        
        <hr>

        
      
        
        <h2 id="-section-id-bra-bra-section-"><section id='bra'>Bra:</section></h2>
<hr>
<p>The <strong><code>Bra</code></strong> class provides representation of a quantum state as a row matrix. Used internally for computing state probabilities.</p>

        
          <div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bra</span></span></pre></div>
        
      
        
        <h3 id="-constructor-"><em>constructor:</em></h3>
<blockquote>
<p>The <strong><code>Bra</code></strong> constructor requires one parameters:</p>
<ul>
<li>A <code>Array</code> as a representation of the quantum state matrix, containing only <a href="complex.html#complex"><strong><code>Complex</code></strong></a> numbers: <code>row</code></li>
</ul>
<p>The constructor function also takes a single optional parameter.</p>
<ul>
<li>A <code>Number</code> which multiplies the whole matrix by a scaling value: <code>constant</code> - defaults to <code>1</code></li>
</ul>
<p>If the arguments are of the incorrect type, the constructor will throw a <a href="#bce"><strong><code>BraConstructorError</code></strong></a>.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@row</span>, constant = <span class="hljs-number">1</span>)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> <span class="hljs-property">@row</span>?
      <span class="hljs-keyword">throw</span> BraConstructorError <span class="hljs-string">'`row` must be defined.'</span>
    <span class="hljs-keyword">unless</span> _.isArray <span class="hljs-property">@row</span>
      <span class="hljs-keyword">throw</span> BraConstructorError <span class="hljs-string">'`row` must be an Array.'</span>
    <span class="hljs-keyword">unless</span> _.isNumber constant
      <span class="hljs-keyword">throw</span> BraConstructorError <span class="hljs-string">'`constant` must be a Number'</span>
    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>..<span class="hljs-property">@row</span>.length]
      <span class="hljs-property">@row</span>[v] = <span class="hljs-keyword">new</span> $C(<span class="hljs-property">@row</span>[v]).multiply constant
    <span class="hljs-property">@size</span> = <span class="hljs-property">@row</span>.length</pre></div>
        
      
        
        <hr>

        
      
        
        <h2 id="-section-id-ket-ket-section-"><section id='ket'>Ket:</section></h2>
<hr>
<p>The <strong><code>Ket</code></strong> class provides representation of a quantum state as a column matrix.</p>

        
          <div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ket</span></span></pre></div>
        
      
        
        <h3 id="-constructor-"><em>constructor:</em></h3>
<blockquote>
<p>The <strong><code>Ket</code></strong> constructor requires one parameters:</p>
<ul>
<li>A <code>Array</code> as a representation of the quantum state matrix, containing only <a href="complex.html#complex"><strong><code>Complex</code></strong></a> numbers: <code>col</code></li>
</ul>
<p>The constructor function also takes a single optional parameter.</p>
<ul>
<li>A <code>Number</code> which multiplies the whole matrix by a scaling value: <code>constant</code> - defaults to <code>1</code></li>
</ul>
<p>If the arguments are of the incorrect type, the constructor will throw a <a href="#kce"><strong><code>KetConstructorError</code></strong></a>.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@col</span>, constant = <span class="hljs-number">1</span>)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> <span class="hljs-property">@col</span>?
      <span class="hljs-keyword">throw</span> KetConstructorError <span class="hljs-string">'`col` must be defined.'</span>
    <span class="hljs-keyword">unless</span> _.isArray <span class="hljs-property">@col</span>
      <span class="hljs-keyword">throw</span> KetConstructorError <span class="hljs-string">'`col` must be an Array.'</span>
    <span class="hljs-keyword">unless</span> _.isNumber constant
      <span class="hljs-keyword">throw</span> KetConstructorError <span class="hljs-string">'`constant` must be a Number'</span>
    <span class="hljs-property">@size</span> = <span class="hljs-property">@col</span>.length
    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>..<span class="hljs-property">@size</span>]
      <span class="hljs-property">@col</span>[v] = <span class="hljs-keyword">new</span> $C(<span class="hljs-property">@col</span>[v]).multiply constant
    <span class="hljs-property">@sumAbsSqrd</span> = _.reduce col, <span class="hljs-function"><span class="hljs-params">((p, n) =&gt; p + Math.pow(n.mag(), <span class="hljs-number">2</span>))</span>, 0

</span></pre></div>
        
      
        
        <hr>
<h3 id="utility-constructor-functions-">Utility Constructor Functions:</h3>

        
      
        
        <p>These functions are attached to the <strong><code>Ket</code></strong> class and provide easy access to some commonly generated Kets:</p>

        
      
        
        <h3 id="-ket-zero-"><em>Ket.Zero:</em></h3>
<blockquote>
<p><strong><code>Ket.Zero</code></strong> creates a new <strong><code>Ket</code></strong> where the state is set to <code>0</code>.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-property">@Zero</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">new</span> $K([<span class="hljs-keyword">new</span> $C(<span class="hljs-number">1</span>), <span class="hljs-keyword">new</span> $C(<span class="hljs-number">0</span>)])</pre></div>
        
      
        
        <h3 id="-ket-one-"><em>Ket.One:</em></h3>
<blockquote>
<p><strong><code>Ket.One</code></strong> creates a new <strong><code>Ket</code></strong> where the state is set to <code>1</code>.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-property">@One</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">new</span> $K([<span class="hljs-keyword">new</span> $C(<span class="hljs-number">0</span>), <span class="hljs-keyword">new</span> $C(<span class="hljs-number">1</span>)])</pre></div>
        
      
        
        <hr>
<h3 id="utility-functions-">Utility Functions:</h3>

        
      
        
        <h3 id="-print-"><em>print:</em></h3>
<blockquote>
<p><strong><code>print</code></strong> outputs a representation of a <strong>Ket</strong> to the console, e.g:</p>
<blockquote>
<p><strong>COFFEESCRIPT:</strong></p>
<pre><code>zero = $K.Zero()
zero.<span class="hljs-built_in">print</span> <span class="hljs-string">'Zero'</span>
</code></pre><p><strong>CONSOLE OUTPUT:</strong></p>
<pre><code>Zero <span class="hljs-attribute">KET</span>:
<span class="hljs-number">1</span> + <span class="hljs-number">0</span>i
<span class="hljs-number">0</span> + <span class="hljs-number">0</span>i
</code></pre></blockquote>
</blockquote>

        
          <div class='highlight'><pre>    
  <span class="hljs-attribute">print</span>: <span class="hljs-function"><span class="hljs-params">(id)</span> -&gt;</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-string">"<span class="hljs-subst">#{id}</span> KET:"</span>
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-property">@col</span>
      <span class="hljs-built_in">console</span>.log <span class="hljs-string">"<span class="hljs-subst">#{c}</span>"</span>
    <span class="hljs-keyword">this</span></pre></div>
        
      
        
        <h3 id="-tobra-"><em>toBra:</em></h3>
<blockquote>
<p><strong><code>toBra</code></strong> is used internally to convert a <strong>Ket</strong> in column matrix form into a <strong>Bra</strong> in row matrix form.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-title">toBra</span> = <span class="hljs-params">(ket)</span> -&gt;</span>
    row = (<span class="hljs-keyword">new</span> $C(val).conjugate() <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> ket.col)
    <span class="hljs-keyword">new</span> Bra(row)</pre></div>
        
      
        
        <hr>
<h3 id="prototypical-instance-functions-">Prototypical Instance Functions:</h3>

        
      
        
        <p>These functions are attached to each instance of the <strong><code>Ket</code></strong> class - changing the function of one <strong><code>Ket</code></strong> changes the function on all other <strong><code>Kets</code></strong> as well. These functions act on a <strong><code>Ket</code></strong> instance in place - the original object is modified.</p>

        
      
        
        <h3 id="-probability-"><em>probability:</em></h3>
<blockquote>
<p><strong><code>probability</code></strong> returns that a probability is in a given state. A <strong><code>Ket</code></strong> represents <em>N</em> bits, and can therefore be in <em>2<sup>N</sup></em> states. The <code>n</code> parameter indicates which state to find the probability of the <strong><code>Ket</code></strong> being in. </p>
<p>Answers are rounded to prevent probabilities such as <code>0.24999999999999999</code> which can occur due to floating-point rounding.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-attribute">probability</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@sumAbsSqrd</span> <span class="hljs-keyword">isnt</span> <span class="hljs-number">0</span>
      precision = +(Math.pow(<span class="hljs-property">@col</span>[n].mag(), <span class="hljs-number">2</span>) / <span class="hljs-property">@sumAbsSqrd</span>).toPrecision <span class="hljs-number">10</span>
      rounded = Math.round precision
      <span class="hljs-keyword">if</span> Math.abs(precision - rounded) &lt; <span class="hljs-number">1e-10</span> <span class="hljs-keyword">then</span> rounded <span class="hljs-keyword">else</span> precision
    <span class="hljs-keyword">else</span> <span class="hljs-number">0</span></pre></div>
        
      
        
        <h3 id="-normalise-"><em>normalise:</em></h3>
<blockquote>
<p><strong><code>normalise</code></strong> divides each value in a <strong><code>Ket</code></strong> by a constant factor - the sum of the absolute values, squared - to make the length of the vector <code>1</code>, thereby <em>normalising</em> the probabilities.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-attribute">normalise</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@sumAbsSqrd</span> <span class="hljs-keyword">isnt</span> <span class="hljs-number">0</span>
      <span class="hljs-property">@col</span> = (<span class="hljs-property">@col</span>[v].divide(Math.sqrt <span class="hljs-property">@sumAbsSqrd</span>) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>..<span class="hljs-property">@size</span>])
      <span class="hljs-property">@sumAbsSqrd</span> = <span class="hljs-number">1</span>
    <span class="hljs-keyword">this</span></pre></div>
        
      
        
        <h3 id="-transition-"><em>transition:</em></h3>
<blockquote>
<p><strong><code>transition</code></strong> finds the transition amplitude between this <strong><code>Ket</code></strong> and another given <strong><code>Ket</code></strong>, by converting the second <strong><code>Ket</code></strong> into a <a href="#bra"><strong><code>Bra</code></strong></a> and multiplying the two together.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-attribute">transition</span>: <span class="hljs-function"><span class="hljs-params">(ket)</span> -&gt;</span>
    bra = toBra ket
    dotProduct = _.reduce [<span class="hljs-number">0.</span>..<span class="hljs-property">@size</span>],
      <span class="hljs-function"><span class="hljs-params">(p, n)</span> =&gt;</span> p.add bra.row[n].multiply <span class="hljs-property">@col</span>[n],
      <span class="hljs-keyword">new</span> $C(<span class="hljs-number">0</span>)</pre></div>
        
      
        
        <h3 id="-ignore-"><em>ignore:</em></h3>
<blockquote>
<p><strong><code>ignore</code></strong> disregards <code>n</code> Qubits in a given <strong><code>Ket</code></strong>, by combining the probabilities that that state occurs with <em>n</em> bits lower than it. </p>
<p>For example, if <code>1</code> Qubit is to be ignored, the new probability that the state is <code>|0&gt;</code> is the probability that the old state was <code>|00&gt;</code> plus the probability that the old state was <code>|01&gt;</code>.</p>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-attribute">ignore</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@normalise</span>()
    val = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>..(<span class="hljs-property">@col</span>.length / Math.pow(<span class="hljs-number">2</span>, n))]
      startN = Math.pow(<span class="hljs-number">2</span>, n) * i
      endN = startN + Math.pow(<span class="hljs-number">2</span>, n)
      val[i] = <span class="hljs-keyword">new</span> $C(<span class="hljs-number">0</span>)
      <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> [startN...endN]
        val[i].add <span class="hljs-keyword">new</span> $C(<span class="hljs-property">@probability</span> p)
    <span class="hljs-property">@col</span> = val
    <span class="hljs-property">@size</span> = val.length
    <span class="hljs-property">@sumAbsSqrd</span> = _.reduce <span class="hljs-property">@col</span>, <span class="hljs-function"><span class="hljs-params">((p, n) =&gt; p + Math.pow(n.mag(), <span class="hljs-number">2</span>))</span>, 0
    <span class="hljs-title">this</span>

</span></pre></div>
        
      
        
        <hr>
<h3 id="static-functions-">Static Functions:</h3>

        
      
        
        <p>These functions belong to the <strong><code>Ket</code></strong> class - any object arguments are not modified and a new object is always returned.</p>

        
      
        
        <h3 id="-ket-combine-"><em>Ket.Combine:</em></h3>
<blockquote>
<p><strong><code>Ket.Combine</code></strong> merges two <strong><code>Kets</code></strong> together by calling the <a href="matrix.html#kron"><strong><code>Matrix.Kron</code></strong></a> function on the two column matrices. </p>
<p>The resulting <strong><code>Ket</code></strong> is in the state that is the combination of the two <strong><code>Kets</code></strong>, e.g.</p>
<blockquote>
<pre><code>kZ = $K.Zero() <span class="hljs-comment">#|0&gt; </span>
KO = $K.One()  <span class="hljs-comment">#|1&gt; </span>
ket = $K.Combine kZ, kO 
ket.<span class="hljs-built_in">print</span> <span class="hljs-string">'ket'</span> 
ket <span class="hljs-attribute">KET</span>: 
<span class="hljs-number">0</span> + <span class="hljs-number">0</span>i 
<span class="hljs-number">1</span> + <span class="hljs-number">0</span>i 
<span class="hljs-number">0</span> + <span class="hljs-number">0</span>i 
<span class="hljs-number">0</span> + <span class="hljs-number">0</span>i 
</code></pre></blockquote>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-property">@Combine</span>: <span class="hljs-function"><span class="hljs-params">(ket1, ket2)</span> -&gt;</span>
    ket1Col = ([v] <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> ket1.col)
    ket1Mat = <span class="hljs-keyword">new</span> $M(ket1Col)
    ket2Col = ([v] <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> ket2.col)
    ket2Mat = <span class="hljs-keyword">new</span> $M(ket2Col)
    <span class="hljs-keyword">new</span> $K(_.flatten $M.Kron([ket1Mat, ket2Mat]).matrix)</pre></div>
        
      
        
        <h3 id="-ket-applygate-"><em>Ket.ApplyGate:</em></h3>
<blockquote>
<p><strong><code>Ket.ApplyGate</code></strong> transforms the state of a <strong><code>Ket</code></strong> by performing a gate operation on it, e.g.</p>
<blockquote>
<pre><code>kZ = $K.Zero() <span class="hljs-comment">#|0&gt; </span>
hadamard = $U.Haramard() 
ket = $K.ApplyGate hadamard, kZ
ket.<span class="hljs-built_in">print</span> <span class="hljs-string">'ket'</span> 
ket <span class="hljs-attribute">KET</span>: 
<span class="hljs-number">0.707</span> + <span class="hljs-number">0.00</span>i 
<span class="hljs-number">0.707</span> + <span class="hljs-number">0.00</span>i 
</code></pre></blockquote>
</blockquote>

        
          <div class='highlight'><pre>  <span class="hljs-property">@ApplyGate</span>: <span class="hljs-function"><span class="hljs-params">(gate, ket)</span> -&gt;</span>
    col = ([v] <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> ket.col)
    ketMat = <span class="hljs-keyword">new</span> Matrix(col)
    result = Matrix.Multiply gate, ketMat
    col = _.flatten result.matrix
    <span class="hljs-keyword">new</span> Ket(col)</pre></div>
        
      
        
        <hr>
<h2 id="exports-">Exports:</h2>

        
      
        
        <p>The <a href="#ket"><strong><code>Ket</code></strong></a> class is added to the global <code>root</code> object, with the alias <a href="#ket"><strong><code>$K</code></strong></a>.</p>

        
          <div class='highlight'><pre>root = <span class="hljs-built_in">exports</span> ? <span class="hljs-keyword">this</span>
root.$K = root.Ket = Ket</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
