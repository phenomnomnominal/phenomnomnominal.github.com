<!DOCTYPE html>  <html> <head>   <title>tetrominoes.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="tetris.html">                 tetris.coffee               </a>                                           <a class="source" href="tetrominoes.html">                 tetrominoes.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               tetrominoes.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">TetriminoBag</span>
  <span class="nv">constructor: </span><span class="o">-&gt;</span>
    <span class="vi">@_ =</span>
      <span class="nv">bag: </span><span class="nx">fillBag</span><span class="p">()</span>
            
  <span class="nv">fillBag = </span><span class="o">-&gt;</span>
    <span class="p">[</span><span class="k">new</span> <span class="nx">I</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
     <span class="k">new</span> <span class="nx">J</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
     <span class="k">new</span> <span class="nx">L</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
     <span class="k">new</span> <span class="nx">O</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
     <span class="k">new</span> <span class="nx">S</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
     <span class="k">new</span> <span class="nx">T</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
     <span class="k">new</span> <span class="nx">Z</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

  <span class="nv">getNext: </span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="o">not</span> <span class="nx">@_</span><span class="p">.</span><span class="nx">bag</span><span class="o">?</span> <span class="o">or</span> <span class="nx">@_</span><span class="p">.</span><span class="nx">bag</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
      <span class="vi">@_.bag = </span><span class="nx">fillBag</span><span class="p">()</span>
    <span class="p">(</span><span class="nx">@_</span><span class="p">.</span><span class="nx">bag</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">@_</span><span class="p">.</span><span class="nx">bag</span><span class="p">.</span><span class="nx">length</span><span class="p">),</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    
<span class="k">class</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(@Colour, @Pivot, @Rotation, @PlusDiff, @MinusDiff) -&gt;</span>
    
  <span class="nv">getDomain: </span><span class="nf">(matrix) -&gt;</span>
    <span class="vi">@Domain = </span><span class="p">[]</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Iterating through each rotation of the Shape...</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="nx">rotation</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">@Shape</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span>
      <span class="nv">shape = </span><span class="nx">@Shape</span><span class="p">[</span><span class="nx">rotation</span><span class="p">]</span>
      <span class="vi">@Rotation = </span><span class="nx">rotation</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Starting at the bottom row...</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="nx">row</span> <span class="k">in</span> <span class="p">[</span><span class="mi">20</span><span class="p">..</span><span class="nx">TetrisGame</span><span class="p">.</span><span class="nx">getHighestRow</span><span class="p">()]</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>and the left-most column...</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">for</span> <span class="nx">column</span> <span class="k">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="mi">10</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>We iterate through each position in the matrix...</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nv">localBoundaries = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>First, we create arrays to store the row and column keys in...</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nv">rowKeys = </span><span class="p">[]</span>
          <span class="nv">columnKeys = </span><span class="p">[]</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>And then populate the localBoundaries object with information about
the Matrix boundaries near the current position.
Imagine we are placing the object in the matrix at its pivot point...
We therefore care about the some number of rows above (@MinusDiff), and below (@PlusDiff)</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">for</span> <span class="nx">boundaryRow</span> <span class="k">in</span> <span class="p">[(</span><span class="nx">row</span><span class="o">-</span><span class="nx">@MinusDiff</span><span class="p">)..(</span><span class="nx">row</span><span class="o">+</span><span class="nx">@PlusDiff</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nx">boundaryRow</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">and</span> <span class="nx">boundaryRow</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">21</span><span class="o">+</span><span class="nx">@PlusDiff</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Store the Row number...</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="nx">rowKeys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">boundaryRow</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>We also care about the some number of columns to the left (@MinusDiff), and right (@PlusDiff)</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="k">for</span> <span class="nx">boundaryColumn</span> <span class="k">in</span> <span class="p">[(</span><span class="nx">column</span><span class="o">-</span><span class="nx">@MinusDiff</span><span class="p">)..(</span><span class="nx">column</span><span class="o">+</span><span class="nx">@PlusDiff</span><span class="p">)]</span>
                <span class="k">if</span> <span class="nx">boundaryColumn</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">and</span> <span class="nx">boundaryColumn</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">11</span><span class="o">+</span><span class="nx">@PlusDiff</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Store the Column number...</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="nx">columnKeys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">boundaryColumn</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Instatiate objects...</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">if</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">]</span> <span class="o">is</span> <span class="kc">undefined</span> <span class="k">then</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Especially for values that are off either side of the defined matrix.</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">if</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">]</span> <span class="o">is</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">is</span> <span class="kc">undefined</span>
                    <span class="k">if</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">is</span> <span class="kc">undefined</span> <span class="k">then</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Otherwise store the value.</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">else</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">=</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Minimize the Row keys down to their unique values and sort them in ascending order.</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nv">rowKeys = </span><span class="nx">_</span><span class="p">.</span><span class="nx">uniq</span><span class="p">(</span><span class="nx">rowKeys</span><span class="p">).</span><span class="nx">sort</span><span class="p">(</span><span class="nf">(a,b) -&gt;</span>
              <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Minimize the Column keys down to their unique values and sort them in ascending order.</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nv">columnKeys = </span><span class="nx">_</span><span class="p">.</span><span class="nx">uniq</span><span class="p">(</span><span class="nx">columnKeys</span><span class="p">).</span><span class="nx">sort</span><span class="p">(</span><span class="nf">(a,b) -&gt;</span>
              <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Go through the local boundaries object, adding any blocks from the @Shape object that exist...
To remove blatantly wrong values from the domain, we throw errows, but ignore them...</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">try</span>
            <span class="nv">shapeRow = </span><span class="mi">0</span>
            <span class="k">for</span> <span class="nx">boundaryRow</span> <span class="k">in</span> <span class="p">[</span><span class="nx">rowKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]..</span><span class="nx">rowKeys</span><span class="p">[</span><span class="nx">rowKeys</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
              <span class="nv">shapeColumn = </span><span class="mi">0</span>
              <span class="k">for</span> <span class="nx">boundaryColumn</span> <span class="k">in</span> <span class="p">[</span><span class="nx">columnKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]..</span><span class="nx">columnKeys</span><span class="p">[</span><span class="nx">columnKeys</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>If a block belongs at this location...</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span> <span class="o">is</span> <span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Check it lies within the playable area...</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">if</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">is</span> <span class="o">-</span><span class="mi">2</span> <span class="o">or</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">is</span> <span class="o">-</span><span class="mi">3</span> 
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&quot;Part of tetromino outside of Matrix&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>If not, check that the space is empty...</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">else</span> <span class="k">if</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">is</span> <span class="mi">0</span> 
                    <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span> <span class="o">*</span> <span class="nx">@Colour</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Otherwise, it must already be occupied</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">else</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&quot;Location already assigned&quot;</span><span class="p">)</span>
                <span class="nx">shapeColumn</span><span class="o">++</span>
              <span class="nx">shapeRow</span><span class="o">++</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Then take the final position the Tetrimino will be in, and make 
sure there is a valid path to it from the top...</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">shapeColumn = </span><span class="mi">0</span>
            <span class="k">for</span> <span class="nx">boundaryColumn</span> <span class="k">in</span> <span class="p">[</span><span class="nx">columnKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]..</span><span class="nx">columnKeys</span><span class="p">[</span><span class="nx">columnKeys</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
              <span class="nv">shapeRow = </span><span class="mi">0</span>
              <span class="k">for</span> <span class="nx">boundaryRow</span> <span class="k">in</span> <span class="p">[</span><span class="nx">rowKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]..</span><span class="nx">rowKeys</span><span class="p">[</span><span class="nx">rowKeys</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="k">if</span> <span class="nx">localBoundaries</span><span class="p">[</span><span class="nx">boundaryRow</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">is</span> <span class="nx">@Colour</span> <span class="o">and</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span> <span class="o">is</span> <span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>This is done by checking the cells directly above any block in the shape...</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="k">for</span> <span class="nx">rowAbove</span> <span class="k">in</span> <span class="p">[</span><span class="nx">boundaryRow</span><span class="p">...</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nx">matrix</span><span class="p">[</span><span class="nx">rowAbove</span><span class="p">][</span><span class="nx">boundaryColumn</span><span class="p">]</span> <span class="o">isnt</span> <span class="mi">0</span>
                      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s">&quot;No path to location&quot;</span><span class="p">)</span>
                  <span class="k">break</span>
                <span class="nx">shapeRow</span><span class="o">++</span>
              <span class="nx">shapeColumn</span><span class="o">++</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>If the domainValue has got this far without erroring, it must be okay...
So we get a score for it, based on it's connectedness in the matrix...</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nv">domainValue = </span>
              <span class="nv">matrix: </span><span class="nx">localBoundaries</span>
              <span class="nv">score: </span><span class="nx">@getScore</span><span class="p">(</span><span class="nx">shape</span><span class="p">,</span> <span class="nx">localBoundaries</span><span class="p">,</span> <span class="nx">matrix</span><span class="p">)</span>
              <span class="nv">Shape: </span><span class="nx">shape</span>
              <span class="nv">Tetrimino: </span><span class="nx">@</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>And if it is greater than 0 (that means it touches an existing Tetrimino)</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="nx">domainValue</span><span class="p">.</span><span class="nx">score</span> <span class="o">&gt;</span> <span class="mi">0</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>We add it to the domain</p>             </td>             <td class="code">               <div class="highlight"><pre>               <span class="nx">@Domain</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">domainValue</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>We sort the domain by its members scores and return it.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="nx">@Domain</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nf">(a, b)-&gt;</span>
      <span class="nx">b</span><span class="p">.</span><span class="nx">score</span> <span class="o">-</span> <span class="nx">a</span><span class="p">.</span><span class="nx">score</span>   
    <span class="p">)</span>
    </pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">function</span> <span class="nv">getScore:</span>
      <span class="nx">For</span> <span class="nx">each</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">shape</span><span class="p">,</span> <span class="nx">sum</span> <span class="nx">the</span> <span class="nx">touching</span> <span class="nx">scores</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">blocks</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shape</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">Shape</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">domain</span> <span class="nx">value</span> <span class="nx">to</span> <span class="nx">score</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">localMatrix</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">local</span> <span class="nx">area</span> <span class="k">in</span> <span class="nx">which</span> <span class="nx">the</span> <span class="nx">shape</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">placed</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">globalMatrix</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">global</span> <span class="nx">Tetris</span> <span class="nx">matrix</span><span class="p">.</span>
  <span class="nx">@</span><span class="k">return</span> <span class="nx">score</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">total</span> <span class="nx">score</span> <span class="k">for</span> <span class="k">this</span> <span class="nx">shape</span><span class="p">.</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">getScore: </span><span class="nf">(shape, localMatrix, globalMatrix) -&gt;</span>
    <span class="nv">downScore = </span><span class="mi">0</span>
    <span class="nv">sideScore = </span><span class="mi">0</span>
    <span class="nv">shapeRow = </span><span class="mi">0</span>
    <span class="k">for</span> <span class="nx">own</span> <span class="nx">row</span><span class="p">,</span> <span class="nx">rowValues</span> <span class="k">of</span> <span class="nx">localMatrix</span>
      <span class="nv">shapeColumn = </span><span class="mi">0</span>
      <span class="k">for</span> <span class="nx">own</span> <span class="nx">column</span><span class="p">,</span> <span class="nx">columnValue</span> <span class="k">of</span> <span class="nx">rowValues</span>
        <span class="k">if</span> <span class="nx">columnValue</span> <span class="o">is</span> <span class="nx">@Colour</span> <span class="o">and</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span> <span class="o">is</span> <span class="mi">1</span>
          <span class="nx">downScore</span> <span class="o">+=</span> <span class="nx">@getDownTouchingScore</span><span class="p">(</span><span class="nx">globalMatrix</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">row</span><span class="p">),</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">column</span><span class="p">),</span> <span class="nx">shape</span><span class="p">,</span> <span class="nx">shapeRow</span><span class="p">,</span> <span class="nx">shapeColumn</span><span class="p">)</span>
          <span class="nx">sideScore</span> <span class="o">+=</span> <span class="nx">@getSideTouchingScore</span><span class="p">(</span><span class="nx">globalMatrix</span><span class="p">,</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">row</span><span class="p">),</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">column</span><span class="p">),</span> <span class="nx">shape</span><span class="p">,</span> <span class="nx">shapeRow</span><span class="p">,</span> <span class="nx">shapeColumn</span><span class="p">)</span>
        <span class="nx">shapeColumn</span><span class="o">++</span>
      <span class="nx">shapeRow</span><span class="o">++</span>
    <span class="k">if</span> <span class="nx">downScore</span> <span class="o">&gt;</span> <span class="mi">0</span>
      <span class="k">return</span> <span class="nx">sideScore</span> <span class="o">+</span> <span class="nx">downScore</span>
    <span class="k">return</span> <span class="mi">0</span>
        </pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">function</span> <span class="nv">getDownTouchingScore:</span>
      <span class="nx">Get</span> <span class="nx">the</span> <span class="nx">Down</span> <span class="nx">Touching</span> <span class="nx">Score</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">block</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">each</span> <span class="nx">floor</span> <span class="o">or</span> <span class="nx">other</span> <span class="nx">block</span>
      <span class="nx">below</span> <span class="nx">the</span> <span class="nx">block</span><span class="p">,</span> <span class="nx">add</span> <span class="nx">one</span> <span class="nx">point</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">score</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">globalMatrix</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">global</span> <span class="nx">Tetris</span> <span class="nx">matrix</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">row</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">row</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">globalMatrix</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">column</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">column</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">globalMatirx</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shape</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">Shape</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">domain</span> <span class="nx">value</span> <span class="nx">to</span> <span class="nx">score</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shapeRow</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">row</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">shape</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shapeColumn</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">column</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">shape</span><span class="p">.</span>
  <span class="nx">@</span><span class="k">return</span> <span class="nx">score</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">total</span> <span class="nx">touching</span> <span class="nx">score</span> <span class="k">for</span> <span class="k">this</span> <span class="nx">block</span><span class="p">.</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">getDownTouchingScore: </span><span class="nf">(globalMatrix, row, column, shape, shapeRow, shapeColumn) -&gt;</span>
    <span class="nv">score = </span><span class="mi">0</span>
    <span class="k">if</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">21</span>
      <span class="nv">blockUnder = </span><span class="nx">globalMatrix</span><span class="p">[</span><span class="nx">row</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">column</span><span class="p">]</span>
      <span class="k">if</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">isnt</span> <span class="kc">undefined</span> <span class="o">and</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span> <span class="o">isnt</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span> <span class="o">and</span> <span class="nx">blockUnder</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="nx">score</span> <span class="o">+=</span> <span class="mi">3</span>
      <span class="k">else</span> <span class="k">if</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">is</span> <span class="kc">undefined</span> <span class="o">and</span> <span class="nx">blockUnder</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="nx">score</span> <span class="o">+=</span> <span class="mi">3</span>
      <span class="k">if</span> <span class="nx">blockUnder</span> <span class="o">is</span> <span class="o">-</span><span class="mi">2</span>
        <span class="nx">score</span> <span class="o">+=</span> <span class="mi">5</span>
    <span class="k">return</span> <span class="nx">score</span>
    </pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">function</span> <span class="nv">getSideTouchingScore:</span>
      <span class="nx">Get</span> <span class="nx">the</span> <span class="nx">Side</span> <span class="nx">Touching</span> <span class="nx">Score</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">block</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">each</span> <span class="nx">wall</span> <span class="o">or</span> <span class="nx">other</span> <span class="nx">block</span>
      <span class="nx">below</span> <span class="nx">the</span> <span class="nx">block</span><span class="p">,</span> <span class="nx">add</span> <span class="nx">one</span> <span class="nx">point</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">score</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">globalMatrix</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">global</span> <span class="nx">Tetris</span> <span class="nx">matrix</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">row</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">row</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">globalMatrix</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">column</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">column</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">globalMatirx</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shape</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">Shape</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">domain</span> <span class="nx">value</span> <span class="nx">to</span> <span class="nx">score</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shapeRow</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">row</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">shape</span><span class="p">.</span>
  <span class="nx">@param</span> <span class="nx">shapeColumn</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">column</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">block</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">shape</span><span class="p">.</span>
  <span class="nx">@</span><span class="k">return</span> <span class="nx">score</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">total</span> <span class="nx">touching</span> <span class="nx">score</span> <span class="k">for</span> <span class="k">this</span> <span class="nx">block</span><span class="p">.</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">getSideTouchingScore: </span><span class="nf">(globalMatrix, row, column, shape, shapeRow, shapeColumn) -&gt;</span>
    <span class="nv">score = </span><span class="mi">0</span>
    <span class="k">if</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">21</span>
      <span class="k">if</span> <span class="nx">column</span> <span class="o">&lt;</span> <span class="mi">11</span> <span class="o">and</span> <span class="nx">column</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="nv">blockLeft = </span><span class="nx">globalMatrix</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">column</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">isnt</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span>
          <span class="k">if</span> <span class="nx">blockLeft</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="nx">score</span> <span class="o">+=</span> <span class="mi">3</span>
        <span class="k">if</span> <span class="nx">blockLeft</span> <span class="o">is</span> <span class="o">-</span><span class="mi">3</span>
          <span class="nx">score</span> <span class="o">+=</span> <span class="mf">2.5</span>
        <span class="nv">blockRight = </span><span class="nx">globalMatrix</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">column</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">isnt</span> <span class="nx">shape</span><span class="p">[</span><span class="nx">shapeRow</span><span class="p">][</span><span class="nx">shapeColumn</span><span class="p">]</span>
          <span class="k">if</span> <span class="nx">blockRight</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="nx">score</span> <span class="o">+=</span> <span class="mi">3</span>
        <span class="k">if</span> <span class="nx">blockRight</span> <span class="o">is</span> <span class="o">-</span><span class="mi">3</span>
          <span class="nx">score</span> <span class="o">+=</span> <span class="mf">2.5</span>
    <span class="k">return</span> <span class="nx">score</span>
    
<span class="k">class</span> <span class="nx">I</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]]</span>
                 
<span class="k">class</span> <span class="nx">J</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]]</span>
     
<span class="k">class</span> <span class="nx">L</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span>
              
<span class="k">class</span> <span class="nx">O</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span>

<span class="k">class</span> <span class="nx">S</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span>
        
<span class="k">class</span> <span class="nx">T</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]]</span>
        
<span class="k">class</span> <span class="nx">Z</span> <span class="k">extends</span> <span class="nx">Tetrimino</span>
  <span class="nv">constructor: </span><span class="nf">(c, p, r, pd, md) -&gt;</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">pd</span><span class="p">,</span> <span class="nx">md</span><span class="p">)</span>
    <span class="vi">@Shape = </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]]</span>
    
<span class="k">this</span><span class="p">.</span><span class="nv">Tetromino = </span><span class="nx">Tetrimino</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 